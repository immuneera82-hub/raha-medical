#!/bin/bash
# ๐ ุฃูุงูุฑ ุชุญุฏูุซ ุงูุณูุฑูุฑ - Raha Medical
# Server Update Commands

echo "================================================"
echo "   ๐ ุชุญุฏูุซ ูููุน Raha Medical ุนูู ุงูุณูุฑูุฑ    "
echo "================================================"
echo ""

# ููุงุญุธุฉ: ูู ุจุชูููุฐ ูุฐู ุงูุฃูุงูุฑ ูุงุญุฏุฉ ุชูู ุงูุฃุฎุฑู

# ============================================
# ุงูุฎุทูุฉ 1๏ธโฃ: ุงูุงุชุตุงู ุจุงูุณูุฑูุฑ
# ============================================
# ุงุณุชุจุฏู 'user' ุจุงุณู ุงููุณุชุฎุฏู ุงููุนูู ู 'your-server-ip' ุจุนููุงู IP ุงูุณูุฑูุฑ
# ูุซุงู: ssh root@167.99.123.456
# ุฃู ุฅุฐุง ูุงู ูุฏูู domain: ssh root@rahamedical.com

ssh user@your-server-ip


# ============================================
# ุจุนุฏ ุงูุงุชุตุงู ุจุงูุณูุฑูุฑุ ูููุฐ ุงูุฃูุงูุฑ ุงูุชุงููุฉ:
# ============================================

# ุงูุฎุทูุฉ 2๏ธโฃ: ุงูุงูุชูุงู ููุฌูุฏ ุงููุดุฑูุน
# ----------------------------------------
cd raha-medical

# ุงูุฎุทูุฉ 3๏ธโฃ: ุงูุชุญูู ูู ุงููุฑุน ุงูุญุงูู
# ----------------------------------------
git branch
# ูุฌุจ ุฃู ูุธูุฑ * main

# ุงูุฎุทูุฉ 4๏ธโฃ: ุณุญุจ ุขุฎุฑ ุงูุชุญุฏูุซุงุช ูู GitHub
# ----------------------------------------
git pull origin main

# ููุงุญุธุฉ: ุฅุฐุง ุธูุฑุช ุฑุณุงูุฉ ุชุนุงุฑุถุ ูุฏ ุชุญุชุงุฌ ุฅูู:
# git stash
# git pull origin main
# git stash pop


# ============================================
# ุงูุฎุทูุฉ 5๏ธโฃ: ุฅุนุงุฏุฉ ุจูุงุก ูุชุดุบูู Docker
# ============================================

# ุฎูุงุฑ A: ุฅุนุงุฏุฉ ุจูุงุก ูุงููุฉ (ููุตู ุจู)
# ----------------------------------------
echo ""
echo "๐ฆ ุฅููุงู ุงูุญุงููุงุช ุงูุญุงููุฉ..."
docker-compose down

echo ""
echo "๐จ ุฅุนุงุฏุฉ ุจูุงุก ุงูุตูุฑ ูู ุฌุฏูุฏ..."
docker-compose build --no-cache

echo ""
echo "โถ๏ธ  ุชุดุบูู ุงูุญุงููุงุช ุงูุฌุฏูุฏุฉ..."
docker-compose up -d

echo ""
echo "โ ุชู ุชุดุบูู ุงูุญุงููุงุช ุจูุฌุงุญ!"


# ุฎูุงุฑ B: ุฅุนุงุฏุฉ ุชุดุบูู ุณุฑูุนุฉ (ููุชุญุฏูุซุงุช ุงูุจุณูุทุฉ)
# ------------------------------------------------
# ุฅุฐุง ููุช ุชูุถู ุฅุนุงุฏุฉ ุชุดุบูู ุณุฑูุนุฉ ุจุฏูู ุฅุนุงุฏุฉ ุจูุงุก:
# docker-compose restart backend
# docker-compose restart caddy


# ============================================
# ุงูุฎุทูุฉ 6๏ธโฃ: ุงูุชุญูู ูู ุญุงูุฉ ุงูุญุงููุงุช
# ============================================
echo ""
echo "๐ ุงูุชุญูู ูู ุญุงูุฉ ุงูุญุงููุงุช..."
docker-compose ps

# ูุฌุจ ุฃู ุชุฑู ุฌููุน ุงูุญุงููุงุช ุจุญุงูุฉ "Up"


# ============================================
# ุงูุฎุทูุฉ 7๏ธโฃ: ูุชุงุจุนุฉ ุงูุณุฌูุงุช (Logs)
# ============================================
echo ""
echo "๐ ุนุฑุถ ุงูุณุฌูุงุช (ุงุถุบุท Ctrl+C ููุฎุฑูุฌ)..."
docker-compose logs -f

# ุฃู ูุนุฑุถ ุขุฎุฑ 100 ุณุทุฑ ููุท:
# docker-compose logs --tail=100

# ุฃู ููุชุงุจุนุฉ ุฎุฏูุฉ ูุนููุฉ ููุท:
# docker-compose logs -f backend
# docker-compose logs -f caddy


# ============================================
# ุงูุฎุทูุฉ 8๏ธโฃ: ุงุฎุชุจุงุฑ ุงููููุน
# ============================================

# ุงุฎุชุจุงุฑ ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ
curl -I https://rahamedical.com

# ุงุฎุชุจุงุฑ API
curl https://api.rahamedical.com/health

# ุงุฎุชุจุงุฑ ุงูุตูุญุงุช ุงููุญุฏุซุฉ
curl -I https://rahamedical.com/terms
curl -I https://rahamedical.com/faq

# ูุฌุจ ุฃู ุชุญุตู ุนูู "200 OK" ููู ุงูุตูุญุงุช


# ============================================
# ุงูุฎุทูุฉ 9๏ธโฃ: ุฅุนุงุฏุฉ ุชุญููู Caddy (ุงุฎุชูุงุฑู)
# ============================================
# ุฅุฐุง ููุช ุจุชุญุฏูุซ Caddyfile:
# docker-compose exec caddy caddy reload --config /etc/caddy/Caddyfile


# ============================================
# ๐ ุชู ุงูุชุญุฏูุซ ุจูุฌุงุญ!
# ============================================

echo ""
echo "================================================"
echo "   โ ุชู ุชุญุฏูุซ ุงููููุน ุจูุฌุงุญ!                  "
echo "================================================"
echo ""
echo "๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ:"
echo "  1. ุชุตูุญ ุงููููุน: https://rahamedical.com"
echo "  2. ุชุญูู ูู ุตูุญุฉ ุงูุดุฑูุท: /terms"
echo "  3. ุชุญูู ูู ุตูุญุฉ FAQ: /faq"
echo "  4. ุชุฃูุฏ ูู ุนูู ุฌููุน ุงูููุฒุงุช"
echo ""
echo "๐ ูู ุญุงูุฉ ูุฌูุฏ ูุดุงูู:"
echo "  - ุฑุงุฌุน ุงูุณุฌูุงุช: docker-compose logs"
echo "  - ุฃุนุฏ ุชุดุบูู ุงูุญุงููุงุช: docker-compose restart"
echo "  - ุชูุงุตู ูุน ุงููุฑูู ุงูุชููู"
echo ""


# ============================================
# ๐ ุฃูุงูุฑ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก
# ============================================

# ุฅุฐุง ูุงุฌูุช ูุดุงููุ ุฌุฑุจ ูุฐู ุงูุฃูุงูุฑ:

# 1. ุนุฑุถ ุงูุณุฌูุงุช ุจุฏูู ูุชุงุจุนุฉ
# docker-compose logs --tail=200

# 2. ุนุฑุถ ุญุงูุฉ ุฌููุน ุงูุญุงููุงุช
# docker ps -a

# 3. ุนุฑุถ ุงุณุชุฎุฏุงู ุงูููุงุฑุฏ
# docker stats

# 4. ุฅุนุงุฏุฉ ุจูุงุก ูุงููุฉ ูุน ุญุฐู ูู ุดูุก (ุงุญุฐุฑ!)
# docker-compose down -v
# docker-compose build --no-cache
# docker-compose up -d

# 5. ุงูุชุญูู ูู ุงูููุงูุฐ ุงููุณุชุฎุฏูุฉ
# netstat -tuln | grep :80
# netstat -tuln | grep :443
# netstat -tuln | grep :5000

# 6. ูุญุต ูุณุงุญุฉ ุงููุฑุต
# df -h

# 7. ูุญุต ุงูุฐุงูุฑุฉ
# free -m

# 8. ุนุฑุถ ุงูุชุฒุงูุงุช Git ุงูุฃุฎูุฑุฉ
# git log --oneline -5


# ============================================
# ๐ ููุงุญุธุงุช ูููุฉ
# ============================================

# โ๏ธ  ุชุฃูุฏ ูู ุฃุฎุฐ ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุจู ุฃู ุชุญุฏูุซ ูุจูุฑ
# โ๏ธ  ูุง ุชุญุฐู ุงูุญุงููุงุช ุจู -v ุฅูุง ุฅุฐุง ููุช ูุชุฃูุฏุงู
# โ๏ธ  ุฑุงูุจ ุงูุณุฌูุงุช ููุฏุฉ 5-10 ุฏูุงุฆู ุจุนุฏ ุงูุชุญุฏูุซ
# โ๏ธ  ุงุฎุชุจุฑ ุงููููุน ูู ุนุฏุฉ ุฃุฌูุฒุฉ ููุชุตูุญุงุช


# ============================================
# ๐ ุฃูุงูุฑ ุงููุณุฎ ุงูุงุญุชูุงุทู (ุงุฎุชูุงุฑู)
# ============================================

# ูุจู ุงูุชุญุฏูุซุ ููููู ุฃุฎุฐ ูุณุฎุฉ ุงุญุชูุงุทูุฉ:

# ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ุงููููุงุช
# tar -czf backup_raha_$(date +%Y%m%d_%H%M%S).tar.gz raha-medical/

# ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช Supabase
# (ุนุงุฏุฉ ุชูุคุฎุฐ ูู ููุญุฉ ุชุญูู Supabase)

# ููู ุงููุณุฎุฉ ูููุงู ุขูู
# mkdir -p /backups
# mv backup_raha_*.tar.gz /backups/


# ============================================
# โน๏ธ  ูุนูููุงุช ุฅุถุงููุฉ
# ============================================

# ุงููููุงุช ุงููุญุฏุซุฉ ูู ูุฐุง ุงูุฅุตุฏุงุฑ:
# โ backend/static/templates/terms.html - ุญุฐู ุณูุงุณุฉ ุงูุฅูุบุงุก
# โ backend/static/templates/faq.html - ุชูุถูุญ ุงูุชูุงููู ุงูุชูุฏูุฑูุฉ
# โ .gitignore - ุชุญุณูู ุงูุญูุงูุฉ
# โ ุฅุถุงูุฉ ูููุงุช ุงูุชูุซูู ุงูุดุงููุฉ

# ุงูุชุญุฏูุซุงุช ุงูุฑุฆูุณูุฉ:
# - ุญุฐู ุงููุณู 7 (ุณูุงุณุฉ ุงูุฅูุบุงุก ูุงูุงุณุชุฑุฏุงุฏ)
# - ุชุนุฏูู ุงููุณู 8 (ุงููุงููู ุงููุนููู ุจู - ุงูููุฏ ููุท)
# - ุชูุถูุญ ุฃู ุงูุชูุงููู ุชูุฏูุฑูุฉ ูู FAQ
# - ุดุฑุญ ูุง ุชุดููู ููุง ูุง ุชุดููู ุงูุชูุงููู
# - ุชุญุณููุงุช ุฃูููุฉ ุดุงููุฉ


# ============================================
# ๐ ูููุณุงุนุฏุฉ ูุงูุฏุนู
# ============================================

# ุงููุซุงุฆู:
# - README.md - ูุธุฑุฉ ุนุงูุฉ ุนู ุงููุดุฑูุน
# - DEPLOYMENT_GUIDE.md - ุฏููู ุงููุดุฑ ุงููุงูู
# - SECURITY_RECOMMENDATIONS.md - ุชูุตูุงุช ุงูุฃูุงู
# - QUICK_COMMANDS.md - ูุฑุฌุน ุงูุฃูุงูุฑ ุงูุณุฑูุนุฉ

# ุฌููุน ูุฐู ุงููููุงุช ูุชููุฑุฉ ูู ูุฌูุฏ ุงููุดุฑูุน ุนูู GitHub

echo "๐ ูููุฒูุฏ ูู ุงููุนูููุงุชุ ุฑุงุฌุน ููู DEPLOYMENT_GUIDE.md"
